<!doctype html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7"><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><meta name="viewport" content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover" ><meta name="generator" content="Jekyll v4.3.3" /><meta property="og:title" content="one step at a time" /><meta name="author" content="fuqiang" /><meta property="og:locale" content="en" /><meta name="description" content="1 2 3 4 5 From: &quot;Jason J. Herne&quot; &lt;jjherne@linux.vnet.ibm.com&gt; To: &quot;qemu-devel@nongnu.org qemu-devel&quot; &lt;qemu-devel@nongnu.org&gt;, Christian Borntraeger &lt;borntraeger@de.ibm.com&gt; Subject: [Qemu-devel] Migration auto-converge problem Date: Mon, 02 Mar 2015 16:04:54 -0500" /><meta property="og:description" content="1 2 3 4 5 From: &quot;Jason J. Herne&quot; &lt;jjherne@linux.vnet.ibm.com&gt; To: &quot;qemu-devel@nongnu.org qemu-devel&quot; &lt;qemu-devel@nongnu.org&gt;, Christian Borntraeger &lt;borntraeger@de.ibm.com&gt; Subject: [Qemu-devel] Migration auto-converge problem Date: Mon, 02 Mar 2015 16:04:54 -0500" /><link rel="canonical" href="/posts/Migration-auto-converge-problem/" /><meta property="og:url" content="/posts/Migration-auto-converge-problem/" /><meta property="og:site_name" content="one step at a time" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2024-11-12T23:20:00+08:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="one step at a time" /><meta name="twitter:site" content="@fuqiang_cai" /><meta name="twitter:creator" content="@fuqiang" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"fuqiang"},"dateModified":"2024-11-12T23:20:00+08:00","datePublished":"2024-11-12T23:20:00+08:00","description":"1 2 3 4 5 From: &quot;Jason J. Herne&quot; &lt;jjherne@linux.vnet.ibm.com&gt; To: &quot;qemu-devel@nongnu.org qemu-devel&quot; &lt;qemu-devel@nongnu.org&gt;, Christian Borntraeger &lt;borntraeger@de.ibm.com&gt; Subject: [Qemu-devel] Migration auto-converge problem Date: Mon, 02 Mar 2015 16:04:54 -0500","headline":"one step at a time","mainEntityOfPage":{"@type":"WebPage","@id":"/posts/Migration-auto-converge-problem/"},"url":"/posts/Migration-auto-converge-problem/"}</script><title>[Translate]: Migration auto-converge problem | one step at a time</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="one step at a time"><meta name="application-name" content="one step at a time"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="preconnect" href="https://cdnjs.cloudflare.com" ><link rel="dns-prefetch" href="https://cdnjs.cloudflare.com" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.5.1/css/all.min.css"><link rel="stylesheet" href="/assets/css/jekyll-theme-chirpy.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot@4.25.0/dist/tocbot.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return 'mode'; } static get MODE_ATTR() { return 'data-mode'; } static get DARK_MODE() { return 'dark'; } static get LIGHT_MODE() { return 'light'; } static get ID() { return 'mode-toggle'; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener('change', () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia('(prefers-color-scheme: dark)'); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { document.documentElement.setAttribute(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { document.documentElement.setAttribute(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { document.documentElement.removeAttribute(ModeToggle.MODE_ATTR); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage( { direction: ModeToggle.ID, message: this.modeStatus }, '*' ); } flipMode() { if (this.hasMode) { if (this.isSysDarkPrefer) { if (this.isLightMode) { this.clearMode(); } else { this.setLight(); } } else { if (this.isDarkMode) { this.clearMode(); } else { this.setDark(); } } } else { if (this.isSysDarkPrefer) { this.setLight(); } else { this.setDark(); } } this.notify(); } /* flipMode() */ } /* ModeToggle */ const modeToggle = new ModeToggle(); </script><body><aside aria-label="Sidebar" id="sidebar" class="d-flex flex-column align-items-end"><header class="profile-wrapper"> <a href="/" id="avatar" class="rounded-circle"></a><h1 class="site-title"> <a href="/">one step at a time</a></h1><p class="site-subtitle fst-italic mb-0">a noob's growing diary</p></header><nav class="flex-column flex-grow-1 w-100 ps-0"><ul class="nav"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tags"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle"></i> <span>ABOUT</span> </a></ul></nav><div class="sidebar-bottom d-flex flex-wrap align-items-center w-100"> <button type="button" class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/cai-fuqiang" aria-label="github" target="_blank" rel="noopener noreferrer" > <i class="fab fa-github"></i> </a> <a href="https://twitter.com/fuqiang_cai" aria-label="twitter" target="_blank" rel="noopener noreferrer" > <i class="fa-brands fa-x-twitter"></i> </a> <a href="javascript:location.href = 'mailto:' + ['iwng86','163.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></aside><div id="main-wrapper" class="d-flex justify-content-center"><div class="container d-flex flex-column px-xxl-5"><header id="topbar-wrapper" aria-label="Top Bar"><div id="topbar" class="d-flex align-items-center justify-content-between px-lg-3 h-100" ><nav id="breadcrumb" aria-label="Breadcrumb"> <span> <a href="/">Home</a> </span> <span>[Translate]: Migration auto-converge problem</span></nav><button type="button" id="sidebar-trigger" class="btn btn-link"> <i class="fas fa-bars fa-fw"></i> </button><div id="topbar-title"> Post</div><button type="button" id="search-trigger" class="btn btn-link"> <i class="fas fa-search fa-fw"></i> </button> <search class="align-items-center ms-3 ms-lg-0"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..." > </search> <button type="button" class="btn btn-link text-decoration-none" id="search-cancel">Cancel</button></div></header><div class="row flex-grow-1"><main aria-label="Main Content" class="col-12 col-lg-11 col-xl-9 px-md-4"><article class="px-1"><header><h1 data-toc-skip>[Translate]: Migration auto-converge problem</h1><div class="post-meta text-muted"> <span> Posted <time data-ts="1731424800" data-df="ll" data-bs-toggle="tooltip" data-bs-placement="bottom" > Nov 12, 2024 </time> </span><div class="d-flex justify-content-between"> <span> By <em> </em> </span><div> <span class="readtime" data-bs-toggle="tooltip" data-bs-placement="bottom" title="2420 words" > <em>13 min</em> read</span></div></div></div></header><div class="content"><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre>From: "Jason J. Herne" &lt;jjherne@linux.vnet.ibm.com&gt;
To: "qemu-devel@nongnu.org qemu-devel" &lt;qemu-devel@nongnu.org&gt;,
	Christian Borntraeger &lt;borntraeger@de.ibm.com&gt;
Subject: [Qemu-devel] Migration auto-converge problem
Date: Mon, 02 Mar 2015 16:04:54 -0500
</pre></table></code></div></div><p>We have a test case that dirties memory very very quickly. When we run this test case in a guest and attempt a migration, that migration never converges even when done with auto-converge on.</p><blockquote><p>我们有一个测试用例会非常快速地修改内存。当我们在虚拟机中运行此测试并尝试迁移时， 即使开启了<code class="language-plaintext highlighter-rouge">auto-converge</code> 功能，迁移仍然无法收敛。</p></blockquote><p>The auto converge behavior of Qemu functions differently purpose than I had expected. In my mind, I expected auto converge to continuously apply adaptive throttling of the cpu utilization of a busy guest if Qemu detects that progress is not being made quickly enough in the guest memory transfer. The idea is that a guest dirtying pages too quickly will be adaptively slowed down by the throttling until migration is able to transfer pages fast enough to complete the migration within the max downtime. Qemu’s current auto converge does not appear to do this in practice.</p><blockquote><p>QEMU 的自动收敛行为与我预期的有所不同。我的设想是，当 QEMU 检测到虚拟机内存 传输进展不足时，auto-converge 会持续 <strong>自适应</strong> 地限制虚拟机的 CPU 利用率。这样， 对于那些脏页速度过快的虚拟机，自适应的限速将逐步降低其速度，直到迁移速度足 够快，能在最大停机时间内完成迁移。然而，QEMU 当前的自动收敛机制在实际操作中 似乎并未实现这一点。</p></blockquote><p>A quick look at the source code shows the following:</p><blockquote><p>查看源码后，逻辑如下:</p></blockquote><ul><li>Autoconverge keeps a counter. This counter is only incremented if, for a completed memory pass, the guest is dirtying pages at a rate of 50% (or more) of our transfer rate.<li>The counter only increments at most once per pass through memory.<li>The counter must reach 4 before any throttling is done. (a minimum of 4 memory passes have to occur) - Once the counter reaches 4, it is immediately reset to 0, and then throttling action is taken. - Throttling occurs by doing an async sleep on each guest cpu for 30ms, exactly one time.</ul><blockquote><ul><li>自动收敛维持一个计数器。仅当一个内存传输周期完成时，虚拟机脏页速率达到传输速率的 50% 或以上，计数器才会增加。<li>每个内存传输周期内计数器最多增加一次。<li>计数器需达到 4 才会触发限速（即至少经历 4 个内存传输周期）– 一旦计数器达到 4， 它会立即重置为 0，然后执行限速操作。</ul></blockquote><p>Now consider the scenario auto-converge is meant to solve (I think): A guest touching lots of memory very quickly. Each pass through memory is going to be sending a lot of pages, and thus, taking a decent amount of time to complete. If, for every four passes, we are <em>only</em> sleeping the guest for 30ms, our guest is still going to be able dirty pages faster than we can transfer them. We will never catch up because the sleep time relative to guest execution time is very very small.</p><blockquote><p>现在考虑 auto-converge 所要解决的场景（我认为）：虚拟机快速修改大量内存。 在这种情况下，每次内存传输周期都会涉及大量页传输，因此需要相当长的时间才能完成。 如果每四个周期我们仅将虚拟机暂停 30 毫秒，那么虚拟机仍然可以比传输速度更快地修 改页。我们永远无法赶上，因为相对于虚拟机的执行时间，暂停时间非常短。</p></blockquote><p>Auto converge, as it is implemented today, does not address the problem I expect it solve. However, after rapid prototyping a new version of auto converge that performs adaptive modeling I’ve learned something. The workload I’m attempting to migrate is actually a pathological case. It is an excellent example of why throttling cpu is not always a good method of limiting memory access. In this test case we are able to touch over 600 MB of pages in 50 ms of continuous execution. In this case, even if I throttle the guest to 5% (50ms runtime, 950ms sleep) we still cannot even come close to catching up even with a fairly speedy network link (which not every user will have).</p><blockquote><p>当前 auto-converge 的实现并未解决我预期的问题。然而，在快速原型实现了一个执行 自适应建模的新版本后，我了解到了一些情况。实际上，我尝试迁移的工作负载是一个 “病理”案例，它很好地说明了限速 CPU 并非限制内存访问的理想方法。在这个测试用例中， 虚拟机在 50 毫秒连续运行时间内可以修改超过 600 MB 的页。即便将虚拟机限速至 5%（50 毫秒运行，950 毫秒暂停），我们仍无法赶上数据传输，即便使用了较高速度的网络连接 （并不是所有用户都有这样的条件）。</p></blockquote><p>Given the above, I believe that some workloads touch memory too fast and we’ll never be able to live migrate them with auto-converge. On the lower end there are workloads that have a very small/stagnant working set size which will be live migratable without the need for auto-converge. Lastly, we have “the nebulous middle”. These are workloads that would benefit from auto-converge because they touch pages too fast for migration to be able to deal with them, AND (important conditional here), throttling will(may?) actually reduce their rate of page modifications. I would like to try and define this “middle” set of workloads.</p><blockquote><p>基于上述情况，我认为有些工作负载的内存修改速度过快，使用 auto-converge 无法实现实 时迁移。在低端情况中，工作负载的工作集很小且变化不大，无需 auto-converge 就可以迁 移成功。最后是所谓的“模糊中间层”。这类工作负载能够受益于 auto-converge，因为它们 的内存修改速度超出了迁移处理能力，并且（这是个关键条件）限速可能（？）会降低其页 修改速率。我希望能够定义这一“中间层”工作负载的特征。</p></blockquote><p>A question with no obvious answer: How much throttling is acceptable? If I have to throttle a guest 90% and he ends up failing 75% of whatever transactions he is attempting to process then we have quite likely defeated the entire purpose of “live” migration. Perhaps it would be better in this case to just stop the guest and do a non-live migration. Maybe by reverting to non-live we actually save time and thus more transactions would have completed. This one may take some experimenting to be able to get a good idea for what makes the most sense. Maybe even have max throttling be be user configurable.</p><blockquote><p>一个没有明确答案的问题：究竟多少限速是可以接受的？如果我需要对虚拟机限速 90%， 而它最终有 75% 的事务处理失败，那我们很可能已经完全违背了“实时”迁移的初衷。 在这种情况下，也许直接停止虚拟机并进行非实时迁移会更好。或许通过回退到非实时迁移， 我们实际上节省了时间，从而完成了更多的事务。这一点可能需要一些实验来更好地了解最 合理的策略。或许最大限速应让用户自行配置。</p></blockquote><p>With all this said, I still wonder exactly how big this “nebulous middle” really is. If, in practice, that “middle” only accounts for 1% of the workloads out there then is it really worth spending time fixing it? Keep in mind this is a two pronged test:</p><blockquote><p>在这一切的前提下，我仍然想知道，这个“模糊中间层”究竟有多大。如果在实际操作中， 这个“中间层”只占所有工作负载的 1%，那么是否真的值得花费时间去优化呢？请记住，这是 一个双重(two pronged)测试：</p></blockquote><ol><li>Guest cannot migrate because it changes memory too fast<li>Cpu throttling slows guest’s memory writes down enough such that he can now migrate</ol><blockquote><ol><li>虚拟机无法迁移，因为它修改内存的速度太快。<li>通过限速虚拟机的 CPU，降低了虚拟机的内存写入速度，从而使得它现在可以迁移。</ol></blockquote><p>I’m interested in any thoughts anyone has. Thanks!</p><h2 id="other-comment"><span class="me-2">other comment</span><a href="#other-comment" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><h3 id="john-snow"><span class="me-2">John Snow</span><a href="#john-snow" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>This is just a passing thought since I have not invested deeply in the live migration convergence mechanisms myself, but:</p><blockquote><p>passing thought: 随意的想法，随便的想法</p><p>这只是一个随便的想法，因为我自己没有深入研究实时迁移收敛机制，但是：</p></blockquote><p>Is it possible to apply a progressively more brutish throttle to a guest if we detect we are not making (or indeed /losing/) progress?</p><blockquote><p>如果我们检测到没有取得进展（甚至是在“失去”进展），是否可以对虚拟机应 用逐渐加剧的强力限速？</p></blockquote><p>We could start with no throttle and see how far we get, then progressively apply a tighter grip on the VM until we make satisfactory progress, then continue on until we hit our “Just pause it and ship the rest” threshold.</p><blockquote><p>我们可以从不限制开始，看看能进行多远，然后逐步对虚拟机施加更紧的限制， 直到取得满意的进展，然后继续进行，直到达到“就暂停它然后传输剩下的部分” 阈值。</p></blockquote><p>That way we allow ourselves the ability to throttle very naughty guests very aggressively (To the point of effectively even paused) without disturbing the niceness of our largely idle guests. In this way, even very high throttle caps should be acceptable.</p><blockquote><p>通过这种方式，我们允许在不打扰大多数空闲虚拟机的情况下，对那些“顽皮”的 虚拟机施加非常强烈的限速（甚至可能暂停）。这样，即便是非常高的限速上限 也应该是可以接受的。</p></blockquote><p>This will allow live migration to “fail gracefully” for cases that are modifying memory or disk just too absurdly fast back to essentially a paused migration.</p><blockquote><p>这将允许实时迁移在那些修改内存或磁盘速度过快的情况下“优雅地失败”， 实际上变成暂停状态的迁移。</p></blockquote><p>I’ll leave it to the migration wizards to explain why I am foolhardy. –js</p><blockquote><p>我将把它留给迁移专家来解释为什么我这么做太愚蠢。</p></blockquote><h2 id="相关链接"><span class="me-2">相关链接</span><a href="#相关链接" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p><a href="https://lore.kernel.org/all/54F4D076.3040402@linux.vnet.ibm.com/">原文链接</a></p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw me-1"></i> <a href="/categories/live-migration/">live_migration</a>, <a href="/categories/auto-converge/">auto-converge</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw me-1"></i> <a href="/tags/autoconverge/" class="post-tag no-text-decoration" >autoconverge</a></div><div class=" post-tail-bottom d-flex justify-content-between align-items-center mt-5 pb-2 " ><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper d-flex align-items-center"> <span class="share-label text-muted">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=[Translate]:%20Migration%20auto-converge%20problem%20-%20one%20step%20at%20a%20time&url=%2Fposts%2FMigration-auto-converge-problem%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Twitter" aria-label="Twitter"> <i class="fa-fw fa-brands fa-square-x-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=[Translate]:%20Migration%20auto-converge%20problem%20-%20one%20step%20at%20a%20time&u=%2Fposts%2FMigration-auto-converge-problem%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Facebook" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=%2Fposts%2FMigration-auto-converge-problem%2F&text=[Translate]:%20Migration%20auto-converge%20problem%20-%20one%20step%20at%20a%20time" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Telegram" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <button id="copy-link" aria-label="Copy link" class="btn small" data-bs-toggle="tooltip" data-bs-placement="top" title="Copy link" data-title-succeed="Link copied successfully!" > <i class="fa-fw fas fa-link pe-none fs-6"></i> </button> </span></div></div></div></article></main><aside aria-label="Panel" id="panel-wrapper" class="col-xl-3 ps-2 mb-5 text-muted"><div class="access"><section id="access-lastmod"><h2 class="panel-heading">Recently Updated</h2><ul class="content list-unstyled ps-0 pb-1 ms-1 mt-2"><li class="text-truncate lh-lg"> <a href="/posts/live-migration-workflow/">live migration</a><li class="text-truncate lh-lg"> <a href="/posts/Migration-auto-converge-problem/">[Translate]: Migration auto-converge problem</a><li class="text-truncate lh-lg"> <a href="/posts/auto-converge/">auto-converge</a><li class="text-truncate lh-lg"> <a href="/posts/dirty-ring/">auto-converge</a><li class="text-truncate lh-lg"> <a href="/posts/mce/">Mce</a></ul></section><section><h2 class="panel-heading">Trending Tags</h2><div class="d-flex flex-wrap mt-3 mb-1 me-3"> <a class="post-tag btn btn-outline-primary" href="/tags/virt/">virt</a> <a class="post-tag btn btn-outline-primary" href="/tags/autoconverge/">autoconverge</a> <a class="post-tag btn btn-outline-primary" href="/tags/para-virt/">para_virt</a> <a class="post-tag btn btn-outline-primary" href="/tags/qemu-hot-upgrade/">qemu_hot_upgrade</a> <a class="post-tag btn btn-outline-primary" href="/tags/acs/">acs</a> <a class="post-tag btn btn-outline-primary" href="/tags/html-details/">html-details</a> <a class="post-tag btn btn-outline-primary" href="/tags/ipmi/">ipmi</a> <a class="post-tag btn btn-outline-primary" href="/tags/live-migration/">live_migration</a> <a class="post-tag btn btn-outline-primary" href="/tags/markdown/">markdown</a> <a class="post-tag btn btn-outline-primary" href="/tags/pcie/">pcie</a></div></section></div><section id="toc-wrapper" class="ps-0 pe-4"><h2 class="panel-heading ps-3 pt-2 mb-2">Contents</h2><nav id="toc"></nav></section></aside></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 px-md-4"><aside id="related-posts" aria-labelledby="related-label"><h3 class="mb-4" id="related-label">Further Reading</h3><nav class="row row-cols-1 row-cols-md-2 row-cols-xl-3 g-4 mb-4"><article class="col"> <a href="/posts/auto-converge/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1731424800" data-df="ll" > Nov 12, 2024 </time><h4 class="pt-0 my-2">auto-converge</h4><div class="text-muted"><p>简介 在大型机器，并且系统负载高时热迁移，工作负载往往比热迁移速度更快，从而导致 live migration无法 converge. 这个往往受限于bandwidth, 虽然现在网卡的带宽越来越高。但是虚拟机的核心数量 以及cpu主频，内存带宽也在逐渐增大。 Chegu Vinod 在 2013 年提出了 auto-converge, （但是的场景即使使用了10Gig NICs也仍然...</p></div></div></a></article><article class="col"> <a href="/posts/dirty-ring/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1731424800" data-df="ll" > Nov 12, 2024 </time><h4 class="pt-0 my-2">auto-converge</h4><div class="text-muted"><p>NONE</p></div></div></a></article><article class="col"> <a href="/posts/live-migration-workflow/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1731424800" data-df="ll" > Nov 12, 2024 </time><h4 class="pt-0 my-2">live migration</h4><div class="text-muted"><p>热迁移简述 热迁移(live migration) 可以在虚拟机正在RUNNING时，对用户透明的从 source host 迁移到dest host. 涉及迁移对象种类 热迁移的流程会大概包含几个对象: cpu 内存 设备 主要工作 而热迁移主要工作是将这几个对象的信息，从原...</p></div></div></a></article></nav></aside><nav class="post-navigation d-flex justify-content-between" aria-label="Post Navigation"> <a href="/posts/live-migration-workflow/" class="btn btn-outline-primary" aria-label="Older" ><p>live migration</p></a> <a href="/posts/auto-converge/" class="btn btn-outline-primary" aria-label="Newer" ><p>auto-converge</p></a></nav><footer aria-label="Site Info" class=" d-flex flex-column justify-content-center text-muted flex-lg-row justify-content-lg-between align-items-lg-center pb-lg-3 " ><p>© <time>2024</time> <a href="https://twitter.com/fuqiang_cai">fuqiang wang</a>. <span data-bs-toggle="tooltip" data-bs-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author." >Some rights reserved.</span></p><p>Using the <a data-bs-toggle="tooltip" data-bs-placement="top" title="v6.5.5" href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener" >Chirpy</a> theme for <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a>.</p></footer></div></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-11 content"><div id="search-hints"><section><h2 class="panel-heading">Trending Tags</h2><div class="d-flex flex-wrap mt-3 mb-1 me-3"> <a class="post-tag btn btn-outline-primary" href="/tags/virt/">virt</a> <a class="post-tag btn btn-outline-primary" href="/tags/autoconverge/">autoconverge</a> <a class="post-tag btn btn-outline-primary" href="/tags/para-virt/">para_virt</a> <a class="post-tag btn btn-outline-primary" href="/tags/qemu-hot-upgrade/">qemu_hot_upgrade</a> <a class="post-tag btn btn-outline-primary" href="/tags/acs/">acs</a> <a class="post-tag btn btn-outline-primary" href="/tags/html-details/">html-details</a> <a class="post-tag btn btn-outline-primary" href="/tags/ipmi/">ipmi</a> <a class="post-tag btn btn-outline-primary" href="/tags/live-migration/">live_migration</a> <a class="post-tag btn btn-outline-primary" href="/tags/markdown/">markdown</a> <a class="post-tag btn btn-outline-primary" href="/tags/pcie/">pcie</a></div></section></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><aside aria-label="Scroll to Top"> <button id="back-to-top" type="button" class="btn btn-lg btn-box-shadow"> <i class="fas fa-angle-up"></i> </button></aside></div><div id="mask"></div><aside id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-bs-animation="true" data-bs-autohide="false" ><div class="toast-header"> <button type="button" class="btn-close ms-auto" data-bs-dismiss="toast" aria-label="Close" ></button></div><div class="toast-body text-center pt-0"><p class="px-2 mb-3">A new version of content is available.</p><button type="button" class="btn btn-primary" aria-label="Update"> Update </button></div></aside><script src="https://cdn.jsdelivr.net/combine/npm/jquery@3.7.1/dist/jquery.min.js,npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js,npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js,npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.umd.min.js,npm/magnific-popup@1.1.0/dist/jquery.magnific-popup.min.js,npm/clipboard@2.0.11/dist/clipboard.min.js,npm/dayjs@1.11.10/dayjs.min.js,npm/dayjs@1.11.10/locale/en.min.js,npm/dayjs@1.11.10/plugin/relativeTime.min.js,npm/dayjs@1.11.10/plugin/localizedFormat.min.js,npm/tocbot@4.25.0/dist/tocbot.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script defer src="/assets/js/dist/app.min.js"></script> <script> /* Note: dependent library will be loaded in `js-selector.html` */ SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<article class="px-1 px-sm-2 px-lg-4 px-xl-0"><header><h2><a href="{url}">{title}</a></h2><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div></header><p>{snippet}</p></article>', noResultsText: '<p class="mt-5">Oops! No results found.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="me-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script>
