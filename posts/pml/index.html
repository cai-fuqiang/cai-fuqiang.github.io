<!doctype html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7"><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><meta name="viewport" content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover" ><meta name="generator" content="Jekyll v4.3.3" /><meta property="og:title" content="protected-mode memory management" /><meta name="author" content="fuqiang" /><meta property="og:locale" content="en" /><meta name="description" content="29.3.6 Page-Modification Logging" /><meta property="og:description" content="29.3.6 Page-Modification Logging" /><link rel="canonical" href="/posts/pml/" /><meta property="og:url" content="/posts/pml/" /><meta property="og:site_name" content="one step at a time" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2024-04-23T11:00:00+08:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="protected-mode memory management" /><meta name="twitter:site" content="@fuqiang_cai" /><meta name="twitter:creator" content="@fuqiang" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"fuqiang"},"dateModified":"2024-04-23T11:00:00+08:00","datePublished":"2024-04-23T11:00:00+08:00","description":"29.3.6 Page-Modification Logging","headline":"protected-mode memory management","mainEntityOfPage":{"@type":"WebPage","@id":"/posts/pml/"},"url":"/posts/pml/"}</script><title>protected-mode memory management | one step at a time</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="one step at a time"><meta name="application-name" content="one step at a time"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="preconnect" href="https://cdnjs.cloudflare.com" ><link rel="dns-prefetch" href="https://cdnjs.cloudflare.com" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.5.1/css/all.min.css"><link rel="stylesheet" href="/assets/css/jekyll-theme-chirpy.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot@4.25.0/dist/tocbot.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return 'mode'; } static get MODE_ATTR() { return 'data-mode'; } static get DARK_MODE() { return 'dark'; } static get LIGHT_MODE() { return 'light'; } static get ID() { return 'mode-toggle'; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener('change', () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia('(prefers-color-scheme: dark)'); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { document.documentElement.setAttribute(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { document.documentElement.setAttribute(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { document.documentElement.removeAttribute(ModeToggle.MODE_ATTR); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage( { direction: ModeToggle.ID, message: this.modeStatus }, '*' ); } flipMode() { if (this.hasMode) { if (this.isSysDarkPrefer) { if (this.isLightMode) { this.clearMode(); } else { this.setLight(); } } else { if (this.isDarkMode) { this.clearMode(); } else { this.setDark(); } } } else { if (this.isSysDarkPrefer) { this.setLight(); } else { this.setDark(); } } this.notify(); } /* flipMode() */ } /* ModeToggle */ const modeToggle = new ModeToggle(); </script><body><aside aria-label="Sidebar" id="sidebar" class="d-flex flex-column align-items-end"><header class="profile-wrapper"> <a href="/" id="avatar" class="rounded-circle"></a><h1 class="site-title"> <a href="/">one step at a time</a></h1><p class="site-subtitle fst-italic mb-0">a noob's growing diary</p></header><nav class="flex-column flex-grow-1 w-100 ps-0"><ul class="nav"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tags"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle"></i> <span>ABOUT</span> </a></ul></nav><div class="sidebar-bottom d-flex flex-wrap align-items-center w-100"> <button type="button" class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/cai-fuqiang" aria-label="github" target="_blank" rel="noopener noreferrer" > <i class="fab fa-github"></i> </a> <a href="https://twitter.com/fuqiang_cai" aria-label="twitter" target="_blank" rel="noopener noreferrer" > <i class="fa-brands fa-x-twitter"></i> </a> <a href="javascript:location.href = 'mailto:' + ['iwng86','163.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></aside><div id="main-wrapper" class="d-flex justify-content-center"><div class="container d-flex flex-column px-xxl-5"><header id="topbar-wrapper" aria-label="Top Bar"><div id="topbar" class="d-flex align-items-center justify-content-between px-lg-3 h-100" ><nav id="breadcrumb" aria-label="Breadcrumb"> <span> <a href="/">Home</a> </span> <span>protected-mode memory management</span></nav><button type="button" id="sidebar-trigger" class="btn btn-link"> <i class="fas fa-bars fa-fw"></i> </button><div id="topbar-title"> Post</div><button type="button" id="search-trigger" class="btn btn-link"> <i class="fas fa-search fa-fw"></i> </button> <search class="align-items-center ms-3 ms-lg-0"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..." > </search> <button type="button" class="btn btn-link text-decoration-none" id="search-cancel">Cancel</button></div></header><div class="row flex-grow-1"><main aria-label="Main Content" class="col-12 col-lg-11 col-xl-9 px-md-4"><article class="px-1"><header><h1 data-toc-skip>protected-mode memory management</h1><div class="post-meta text-muted"> <span> Posted <time data-ts="1713841200" data-df="ll" data-bs-toggle="tooltip" data-bs-placement="bottom" > Apr 23, 2024 </time> </span><div class="d-flex justify-content-between"> <span> By <em> </em> </span><div> <span class="readtime" data-bs-toggle="tooltip" data-bs-placement="bottom" title="1696 words" > <em>9 min</em> read</span></div></div></div></header><div class="content"><h2 id="2936-page-modification-logging"><span class="me-2">29.3.6 Page-Modification Logging</span><a href="#2936-page-modification-logging" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>When accessed and dirty flags for EPT are enabled, software can track writes to guest-physical addresses using a feature called page-modification logging.</p><blockquote><p>当启用了 EPT 的访问和脏标志时，软件可以使用一种称为PML记录的功能来 跟踪对客户物理地址的写操作。</p></blockquote><p>Software can enable page-modification logging by setting the “enable PML” VM-execution control (see Table 25-7 in Section 25.6.2). When this control is 1, the processor adds entries to the page-modification log as described below. The page-modification log is a 4-KByte region of memory located at the physical address in the PML address VM-execution control field. The page-modification log consists of 512 64-bit entries; the PML index VM-execution control field indicates the next entry to use.</p><blockquote><p>软件可以通过设置“enable PML” VM-execution control（参见第 25.6.2 节的表 25-7） 来启用PML 记录。当该控制位为 1 时，处理器会按照下面描述的方式将条目添加到 PML 中。PML 是一个 4 KB 的内存区域，位于 PML 地址虚拟机执行控制字段中指定的物 理地址。PML 由 512 个 64 位条目组成；PML 索引虚拟机执行控制字段指示下一个要使 用的条目。</p></blockquote><p>Before allowing a guest-physical access, the processor may determine that it first needs to set an accessed or dirty flag for EPT (see Section 29.3.5). When this happens, the processor examines the PML index. If the PML index is not in the range 0–511, there is a page-modification log-full event and a VM exit occurs. In this case, the accessed or dirty flag is not set, and the guest-physical access that triggered the event does not occur.</p><blockquote><p>在允许客户物理访问之前，处理器可能会确定它首先需要为 EPT 设置访问或脏标志 （参见第 29.3.5 节）。当发生这种情况时，处理器会检查 PML 索引。如果 PML 索引不在 0-511 的范围内，就会发生PML log full event ，并且会产生 VM exit。 在这种情况下，访问或脏标志不会被设置，并且触发事件的客户物理访问也不会发生。</p></blockquote><p>If instead the PML index is in the range 0–511, the processor proceeds to update accessed or dirty flags for EPT as described in Section 29.3.5. If the processor updated a dirty flag for EPT (changing it from 0 to 1), it then operates as follows:</p><blockquote><p>如果 PML 索引在 0-511 的范围内，处理器会继续按照第 29.3.5 节中描述的方式更新 EPT 的访问或脏标志。如果处理器更新了 EPT 的脏标志（将其从 0 变为 1），则它会 继续执行以下操作：</p></blockquote><ol><li><p>The guest-physical address of the access is written to the page-modification log. Specifically, the guest- physical address is written to physical address determined by adding 8 times the PML index to the PML address. Bits 11:0 of the value written are always 0 (the guest-physical address written is thus 4-KByte aligned).</p><blockquote><p>访问的 GPA 被写入PML。具体来说，GPA被写入通过将 PML address 加上 PML index 乘以 8 所确定的物理地址。写入值的第 11 到 0 位始终为 0（因此写入的GPA是 4 KB 对齐的）。</p></blockquote><li><p>The PML index is decremented by 1 (this may cause the value to transition from 0 to FFFFH).</p><blockquote><p>PML 索引减 1（这可能导致其值从 0 变为 FFFFH）。</p></blockquote></ol><p>Because the processor decrements the PML index with each log entry, the value may transition from 0 to FFFFH. At that point, no further logging will occur, as the processor will determine that the PML index is not in the range 0– 511 and will generate a page-modification log-full event (see above).</p><blockquote><p>由于处理器在每次日志记录时都会将 PML 索引减 1，该值可能会从 0 变为 FFFFH。 此时，将不再进行日志记录，因为处理器会判断 PML 索引不在 0 到 511 的范围内， 并触发page-modification log-full event。</p></blockquote><h3 id="2937-ept-and-memory-typing"><span class="me-2">29.3.7 EPT and Memory Typing</span><a href="#2937-ept-and-memory-typing" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>This section specifies how a logical processor determines the memory type use for a memory access while EPT is in use. (See Chapter 12, “Memory Cache Control‚” of the Intel® 64 and IA-32 Architectures Software Developer’s Manual, Volume 3A, for details of memory typing in the Intel 64 architecture.) Section 29.3.7.1 explains how the memory type is determined for accesses to the EPT paging structures. Section 29.3.7.2 explains how the memory type is determined for an access using a guest-physical address that is translated using EPT.</p><blockquote><p>这一部分说明了在使用扩展页表（EPT）时，逻辑处理器如何确定内存访问所使用的内存类型。 （有关 Intel 64 架构中的内存类型的详细信息，请参阅《Intel® 64 和 IA-32 架构软件开 发人员手册》第 3A 卷第 12 章“Memory Cache Control”。）第 29.3.7.1 节解释了如何确 定对 EPT 分页结构访问的内存类型。第 29.3.7.2 节解释了如何确定使用 EPT 翻译的 GPA 进行访问时的内存类型。</p></blockquote><h4 id="29371-memory-type-used-for-accessing-ept-paging-structures"><span class="me-2">29.3.7.1 Memory Type Used for Accessing EPT Paging Structures</span><a href="#29371-memory-type-used-for-accessing-ept-paging-structures" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>This section explains how the memory type is determined for accesses to the EPT paging structures. The determi- nation is based first on the value of bit 30 (cache disable—CD) in control register CR0:</p><blockquote><p>这一部分解释了如何确定对 EPT 分页结构访问时的内存类型。首先，这一确定过程基于控制寄 存器 CR0 中第 30 位（disable—CD）的值：</p></blockquote><ul><li>If CR0.CD = 0, the memory type used for any such reference is the EPT paging-structure memory type, which is specified in bits 2:0 of the extended-page-table pointer (EPTP), a VM-execution control field (see Section 25.6.11). A value of 0 indicates the uncacheable type (UC), while a value of 6 indicates the write-back type (WB). Other values are reserved.<blockquote><p>如果 CR0.CD = 0，则用于任何此类引用的内存类型是 EPT 分页结构的内存类型， 该类型在扩展页表指针（EPTP）的位 2:0 中指定，这是一个 VM-execution control field（参见第 25.6.11 节）。值为 0 表示不可缓存类型（UC）， 而值为 6 表示写回类型（WB）。其他值是保留的。</p></blockquote><li>If CR0.CD = 1, the memory type used for any such reference is uncacheable (UC).<blockquote><p>如果 CR0.CD = 1，则用于任何此类引用的内存类型是不可缓存的（UC）。</p></blockquote></ul><p>The MTRRs have no effect on the memory type used for an access to an EPT paging structure.</p><h4 id="29372-memory-type-used-for-translated-guest-physical-addresses"><span class="me-2">29.3.7.2 Memory Type Used for Translated Guest-Physical Addresses</span><a href="#29372-memory-type-used-for-translated-guest-physical-addresses" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>The effective memory type of a memory access using a guest-physical address (an access that is translated using EPT) is the memory type that is used to access memory. The effective memory type is based on the value of bit 30 (cache disable—CD) in control register CR0; the last EPT paging-structure entry used to translate the guest- physical address (either an EPT PDE with bit 7 set to 1 or an EPT PTE); and the PAT memory type (see below):</p><ul><li>The PAT memory type depends on the value of CR0.PG:<ul><li>If CR0.PG = 0, the PAT memory type is WB (writeback).1<li>If CR0.PG = 1, the PAT memory type is the memory type selected from the IA32_PAT MSR as specified in Section 12.12.3, “Selecting a Memory Type from the PAT.”2</ul><li><p>The EPT memory type is specified in bits 5:3 of the last EPT paging-structure entry: 0 = UC; 1 = WC; 4 = WT; 5 = WP; and 6 = WB. Other values are reserved and cause EPT misconfigurations (see Section 29.3.3).</p><li>If CR0.CD = 0, the effective memory type depends upon the value of bit 6 of the last EPT paging-structure entry:<ul><li>If the value is 0, the effective memory type is the combination of the EPT memory type and the PAT memory type specified in Table 12-7 in Section 12.5.2.2, using the EPT memory type in place of the MTRR memory type.<li>If the value is 1, the memory type used for the access is the EPT memory type. The PAT memory type is ignored.</ul><li>If CR0.CD = 1, the effective memory type is UC.</ul><p>The MTRRs have no effect on the memory type used for an access to a guest-physical address.</p><h2 id="流程图展示"><span class="me-2">流程图展示</span><a href="#流程图展示" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p><img src="./pic/PML.svg" alt="流程图" /></p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw me-1"></i> <a href="/categories/intel-sdm/">intel_sdm</a>, <a href="/categories/pml/">pml</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw me-1"></i> <a href="/tags/virt/" class="post-tag no-text-decoration" >virt</a> <a href="/tags/pml/" class="post-tag no-text-decoration" >pml</a></div><div class=" post-tail-bottom d-flex justify-content-between align-items-center mt-5 pb-2 " ><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper d-flex align-items-center"> <span class="share-label text-muted">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=protected-mode%20memory%20management%20-%20one%20step%20at%20a%20time&url=%2Fposts%2Fpml%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Twitter" aria-label="Twitter"> <i class="fa-fw fa-brands fa-square-x-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=protected-mode%20memory%20management%20-%20one%20step%20at%20a%20time&u=%2Fposts%2Fpml%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Facebook" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=%2Fposts%2Fpml%2F&text=protected-mode%20memory%20management%20-%20one%20step%20at%20a%20time" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Telegram" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <button id="copy-link" aria-label="Copy link" class="btn small" data-bs-toggle="tooltip" data-bs-placement="top" title="Copy link" data-title-succeed="Link copied successfully!" > <i class="fa-fw fas fa-link pe-none fs-6"></i> </button> </span></div></div></div></article></main><aside aria-label="Panel" id="panel-wrapper" class="col-xl-3 ps-2 mb-5 text-muted"><div class="access"><section id="access-lastmod"><h2 class="panel-heading">Recently Updated</h2><ul class="content list-unstyled ps-0 pb-1 ms-1 mt-2"><li class="text-truncate lh-lg"> <a href="/posts/dirty-tracking/">dirty tracking</a><li class="text-truncate lh-lg"> <a href="/posts/vfio/">vfio</a><li class="text-truncate lh-lg"> <a href="/posts/host-bridge/">host-bridge is pci device BUT NOT pci bridge</a><li class="text-truncate lh-lg"> <a href="/posts/wbinvd-emulate/">emulate wbinvd</a><li class="text-truncate lh-lg"> <a href="/posts/pci_bridge/">qemu brige migration</a></ul></section><section><h2 class="panel-heading">Trending Tags</h2><div class="d-flex flex-wrap mt-3 mb-1 me-3"> <a class="post-tag btn btn-outline-primary" href="/tags/virt/">virt</a> <a class="post-tag btn btn-outline-primary" href="/tags/para-virt/">para_virt</a> <a class="post-tag btn btn-outline-primary" href="/tags/autoconverge/">autoconverge</a> <a class="post-tag btn btn-outline-primary" href="/tags/live-migration/">live_migration</a> <a class="post-tag btn btn-outline-primary" href="/tags/pcie/">pcie</a> <a class="post-tag btn btn-outline-primary" href="/tags/qemu-hot-upgrade/">qemu_hot_upgrade</a> <a class="post-tag btn btn-outline-primary" href="/tags/acs/">acs</a> <a class="post-tag btn btn-outline-primary" href="/tags/apic-timer/">apic-timer</a> <a class="post-tag btn btn-outline-primary" href="/tags/dirty-rate/">dirty rate</a> <a class="post-tag btn btn-outline-primary" href="/tags/dirty-bitmap/">dirty-bitmap</a></div></section></div><section id="toc-wrapper" class="ps-0 pe-4"><h2 class="panel-heading ps-3 pt-2 mb-2">Contents</h2><nav id="toc"></nav></section></aside></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 px-md-4"><aside id="related-posts" aria-labelledby="related-label"><h3 class="mb-4" id="related-label">Further Reading</h3><nav class="row row-cols-1 row-cols-md-2 row-cols-xl-3 g-4 mb-4"><article class="col"> <a href="/posts/vm86/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1713753000" data-df="ll" > Apr 22, 2024 </time><h4 class="pt-0 my-2">vm86</h4><div class="text-muted"><p>FROM intel sdm chapter 21 8086 emulation abstract IA-32 processors (beginning with the Intel386 processor) provide two ways to execute new or legacy programs that are assembled and/or compiled t...</p></div></div></a></article><article class="col"> <a href="/posts/proctected-mode/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1713841200" data-df="ll" > Apr 23, 2024 </time><h4 class="pt-0 my-2">protected-mode memory management</h4><div class="text-muted"><p>FROM intel sdm CHAPTER 3 PROTECTED-MODE MEMORY MANAGEMENT abstract This chapter describes the Intel 64 and IA-32 architecture’s protected-mode memory management facilities, including the phys...</p></div></div></a></article><article class="col"> <a href="/posts/virtualization-cr0/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1713954600" data-df="ll" > Apr 24, 2024 </time><h4 class="pt-0 my-2">virtualization cr0</h4><div class="text-muted"><p>Guest/Host Masks and Read Shadows for CR0 and CR4 FROM intel sdm 1 2 3 CHAPTER 25 VIRTUAL MACHINE CONTROL STRUCTURES 25.6 VM-EXECUTION CONTROL FIELDS 25.6.6 VM-execution control f...</p></div></div></a></article></nav></aside><nav class="post-navigation d-flex justify-content-between" aria-label="Post Navigation"> <a href="/posts/enter-protect-mode/" class="btn btn-outline-primary" aria-label="Older" ><p>when load control register during in switching rmode 2 pmode</p></a> <a href="/posts/proctected-mode/" class="btn btn-outline-primary" aria-label="Newer" ><p>protected-mode memory management</p></a></nav><footer aria-label="Site Info" class=" d-flex flex-column justify-content-center text-muted flex-lg-row justify-content-lg-between align-items-lg-center pb-lg-3 " ><p>© <time>2025</time> <a href="https://twitter.com/fuqiang_cai">fuqiang wang</a>. <span data-bs-toggle="tooltip" data-bs-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author." >Some rights reserved.</span></p><p>Using the <a data-bs-toggle="tooltip" data-bs-placement="top" title="v6.5.5" href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener" >Chirpy</a> theme for <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a>.</p></footer></div></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-11 content"><div id="search-hints"><section><h2 class="panel-heading">Trending Tags</h2><div class="d-flex flex-wrap mt-3 mb-1 me-3"> <a class="post-tag btn btn-outline-primary" href="/tags/virt/">virt</a> <a class="post-tag btn btn-outline-primary" href="/tags/para-virt/">para_virt</a> <a class="post-tag btn btn-outline-primary" href="/tags/autoconverge/">autoconverge</a> <a class="post-tag btn btn-outline-primary" href="/tags/live-migration/">live_migration</a> <a class="post-tag btn btn-outline-primary" href="/tags/pcie/">pcie</a> <a class="post-tag btn btn-outline-primary" href="/tags/qemu-hot-upgrade/">qemu_hot_upgrade</a> <a class="post-tag btn btn-outline-primary" href="/tags/acs/">acs</a> <a class="post-tag btn btn-outline-primary" href="/tags/apic-timer/">apic-timer</a> <a class="post-tag btn btn-outline-primary" href="/tags/dirty-rate/">dirty rate</a> <a class="post-tag btn btn-outline-primary" href="/tags/dirty-bitmap/">dirty-bitmap</a></div></section></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><aside aria-label="Scroll to Top"> <button id="back-to-top" type="button" class="btn btn-lg btn-box-shadow"> <i class="fas fa-angle-up"></i> </button></aside></div><div id="mask"></div><aside id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-bs-animation="true" data-bs-autohide="false" ><div class="toast-header"> <button type="button" class="btn-close ms-auto" data-bs-dismiss="toast" aria-label="Close" ></button></div><div class="toast-body text-center pt-0"><p class="px-2 mb-3">A new version of content is available.</p><button type="button" class="btn btn-primary" aria-label="Update"> Update </button></div></aside><script src="https://cdn.jsdelivr.net/combine/npm/jquery@3.7.1/dist/jquery.min.js,npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js,npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js,npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.umd.min.js,npm/magnific-popup@1.1.0/dist/jquery.magnific-popup.min.js,npm/clipboard@2.0.11/dist/clipboard.min.js,npm/dayjs@1.11.10/dayjs.min.js,npm/dayjs@1.11.10/locale/en.min.js,npm/dayjs@1.11.10/plugin/relativeTime.min.js,npm/dayjs@1.11.10/plugin/localizedFormat.min.js,npm/tocbot@4.25.0/dist/tocbot.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script defer src="/assets/js/dist/app.min.js"></script> <script> /* Note: dependent library will be loaded in `js-selector.html` */ SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<article class="px-1 px-sm-2 px-lg-4 px-xl-0"><header><h2><a href="{url}">{title}</a></h2><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div></header><p>{snippet}</p></article>', noResultsText: '<p class="mt-5">Oops! No results found.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="me-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script>
